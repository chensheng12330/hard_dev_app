C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND PRINT(.\list\main.lst)

line level    source

   1          
   2          /*------------------------------------------------------------------*/
   3          /* --- STC MCU International Limited -------------------------------*/
   4          /* --- STC 1T Series MCU RC Demo -----------------------------------*/
   5          /* --- Mobile: (86)13922805190 -------------------------------------*/
   6          /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
   7          /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
   8          /* --- Web: www.GXWMCU.com -----------------------------------------*/
   9          /* --- QQ:  800003751 ----------------------------------------------*/
  10          /* If you want to use the program or the program referenced in the  */
  11          /* article, please specify in which data and procedures from STC    */
  12          /*------------------------------------------------------------------*/
  13          //#include "reg51.h"
  14          #include        "config.h"
  15          #include        "timer.h"
  16          #include        "GPIO.h"
  17          //#include      "soft_uart.h"
  18          #include        "delay.h"
  19          #include        "Exti.h"
  20          
  21          
  22          /*************  ¹¦ÄÜËµÃ÷        **************
  23          
  24          ¸Ä×°[×Ô¶¯ÅçÏã»ú]
  25          
  26          1¡¢Ò»ÌìÅçÊ±¼äÉèÖÃÎª£º7µã£¬13µã£¬19µã
  27          2¡¢
  28          T(io) °´¼üÓÃÓÚÃ¿Ìì12µã½Ï×¼Ê±¼ä£¬´¥·¢¼´Éè¶¨µ±Ç°Ê ±¼äÎª12µã.
  29          M ÓÃÓÚÖ÷¶¯´¥·¢ÅçÏã»úÔËÐÐÒ»´Î¡£
  30          S  ¹Ø±Õµ±³ÌÐòÔËÐÐ.
  31          
  32          3¡¢L1(ÂÌio0)ÏÔÊ¾µ±Ç°×´Ì¬£¬
  33          10ÃëÉÁÒ»´Î£¬±íÊ¾»úÆ÷¶¨Ê±ÔËÐÐÖÐ¡£
  34          ³£ÁÁ±íÊ¾µç³Ø²»×ã¡£
  35          
  36          L2(ºìio1)ÉÁÒ»´Î£¬±íÊ¾Ê±¼ä½Ï×¼Íê³É¡£
  37          L2(ºì)ÉÁ¶þ´Î£¬±íÊ¾¼ÆÊý»Ö¸´Íê³É¡£ 
  38          L2(ºì)ÉÁÈý´Î£¬±íÊ¾¹Ø±Õ¶¨Ê±
  39          
  40          /*stc15f104w Òý½Å°²ÅÅ
  41          *********************************************************
  42          ×Ô¶¯Ä£Ê½  p3.4  -- ||--p3.3  ÅçÏã»ú°´¼ü¿ØÖÆÊäÈë
  43          ÕýµçÔ´       vcc    -- ||--p3.2  Ê±¼äÖØÖÃ°´¼ü¿ØÖÆÊäÈë
  44          µç»ú¿ª¹Ø  p3.5  -- ||--p3.1  ºìµÆ
  45          ¸ºµçÔ´        gnd  -- ||--p3.0  ÂÌµÆ
  46          *********************************************************
  47          
  48          */
  49          
  50          /******************************************/
  51          
  52          /*************  ±¾µØ³£Á¿ÉùÃ÷    **************/
  53          #define l2Num_TimeRest_1 1
  54          #define l2Num_MotoRun_2  2
  55          #define k_addNum 50 //50 //¶¨Ê±µþ¼ÓÊý
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 2   

  56          #define k_moto_run_time (500) //500ms //µç»úÆôÊ±¼äÖµ¡£
  57          
  58          /*************  ±¾µØ±äÁ¿ÉùÃ÷    **************/
  59          u8 g_hour=6;  //Ê±
  60          u8  g_minute=59;//·Ö
  61          u8  g_second=50;//Ãë
  62          u16 g_millisecond=0;//ºÁÃë 
  63          
  64          
  65          
  66          sbit ioOutForL1Green= P3^0;  //ÂÌµÆ£¬³ÌÐòÔËÐÐÖ¸Ê¾µÆ
  67          sbit ioOutForL2Red  = P3^1;  //ºìµÆ£¬°´¼üÏìÓ¦Ö¸Ê¾µÆ
  68          
  69          sbit ioInKeyForMoto = P3^2;//ÅçÏã»ú´¥·¢ÔËÐÐÊäÈë  int0
  70          sbit ioInKeyForTime = P3^3; //Ê±¼ä½Ï×¼°´¼üÊäÈë  int1
  71          
  72          
  73          sbit ioOutForMotoPower=P3^5;  //ÅçÏã»úµç»úÆô¶¯¿ª¹ØIO¿Ú.
  74          //sbit ioOutForMotoKey= P3^4;  //ÔÝÊ±²»×ö´¦Àí£¬±£ÁôIO¿Ú
  75          
  76          
  77          
  78          int g_moto_run_time=0; //µç»úÆô¶¯ÔËÐÐºóµÄÊ±¼äÖµ
  79           
  80          typedef struct
  81          {
  82                  u8      sKeyForTime;  //ÖØÖÃÊ±¼ä¼ü×´Ì¬Öµ.  0: Î´°´ÏÂ  //1:ÒÑ°´ÏÂ
  83                  //u8    sKeyForRun;       //³ÌÐò¼ü×´Ì¬Öµ.  0: Î´°´ÏÂ  //1:ÒÑ°´ÏÂ
  84                  u8     sKeyForMoto;  //ÅçÏã»ú¼ü×´Ì¬Öµ.  0: Î´°´ÏÂ  //1:ÒÑ°´ÏÂ
  85          } KeyStateDef; //µ±Ç°³ÌÐò°´¼üµÄ×´Ì¬,Ä¬ÈÏÎª0 
  86          
  87          //È«¾Ö¶ÔÏó
  88          KeyStateDef  g_allKeyState={0,0};
  89          
  90          
  91          /*************  ±¾µØº¯ÊýÉùÃ÷    **************/
  92          
  93          //void mintueAction(void);
  94          
  95          void secondAction(void);
  96          
  97          //void printNowTime(void);
  98          
  99          void key_scan(void);
 100          
 101          void l2ShowWithNum(u8 num);
 102          
 103          void motoStart(void);
 104          /*************  Íâ²¿º¯ÊýºÍ±äÁ¿ÉùÃ÷ *****************/
 105          void    EXTI_config(void)
 106          {
 107   1              EXTI_InitTypeDef        EXTI_InitStructure;                                     //½á¹¹¶¨Òå
 108   1      
 109   1          //³õÊ¼»¯INT0
 110   1              EXTI_InitStructure.EXTI_Mode      = EXT_MODE_Fall;      //ÖÐ¶ÏÄ£Ê½,  EXT_MODE_RiseFall, EXT_MODE_Fall
 111   1              EXTI_InitStructure.EXTI_Polity    = PolityHigh;                 //ÖÐ¶ÏÓÅÏÈ¼¶,   PolityLow,PolityHigh
 112   1              EXTI_InitStructure.EXTI_Interrupt = ENABLE;                             //ÖÐ¶ÏÔÊÐí,     ENABLE»òDISABLE
 113   1              Ext_Inilize(EXT_INT0,&EXTI_InitStructure);      
 114   1          
 115   1          //³õÊ¼»¯INT1
 116   1              EXTI_InitStructure.EXTI_Mode      = EXT_MODE_Fall;      //ÖÐ¶ÏÄ£Ê½,     EXT_MODE_RiseFall, EXT_MODE_Fall
 117   1              EXTI_InitStructure.EXTI_Polity    = PolityLow;                  //ÖÐ¶ÏÓÅÏÈ¼¶,   PolityLow,PolityHigh
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 3   

 118   1              //EXTI_InitStructure.EXTI_Interrupt = ENABLE;                           //ÖÐ¶ÏÔÊÐí,     ENABLE»òDISABLE
 119   1              Ext_Inilize(EXT_INT1,&EXTI_InitStructure);                              //      EXT_INT0,EXT_INT1,EXT_INT2,EXT_INT3,EXT_INT4
 120   1      
 121   1      /*
 122   1          //³õÊ¼»¯INT3
 123   1              EXTI_InitStructure.EXTI_Mode      = EXT_MODE_Fall;      //ÖÐ¶ÏÄ£Ê½,     EXT_MODE_RiseFall, EXT_MODE_Fall
 124   1              EXTI_InitStructure.EXTI_Polity    = PolityLow;                  //ÖÐ¶ÏÓÅÏÈ¼¶,   PolityLow,PolityHigh
 125   1              EXTI_InitStructure.EXTI_Interrupt = ENABLE;                             //ÖÐ¶ÏÔÊÐí,     ENABLE»òDISABLE
 126   1              Ext_Inilize(EXT_INT3,&EXTI_InitStructure);
 127   1              */
 128   1      }
 129          
 130          
 131          
 132          /************************ IO¿ÚÅäÖÃ ****************************/
 133          void    GPIO_config(void)
 134          {
 135   1              GPIO_InitTypeDef        GPIO_InitStructure;                             //½á¹¹¶¨Òå
 136   1              GPIO_InitStructure.Pin  = GPIO_Pin_0 | GPIO_Pin_1| GPIO_Pin_4|GPIO_Pin_5;       //Ö¸¶¨Òª³õÊ¼»¯µÄIO, 
 137   1              // GPIO_Pin_2 ~ GPIO_Pin_3, »ò²Ù×÷
 138   1              GPIO_InitStructure.Mode = GPIO_OUT_PP;                          //Ö¸¶¨IOµÄÊäÈë»òÊä³ö·½Ê½,GPIO_PullUp,GPIO_HighZ,GPIO_OUT_OD,GPI
             -O_OUT_PP
 139   1              GPIO_Inilize(GPIO_P3,&GPIO_InitStructure);                      //³õÊ¼»¯
 140   1      
 141   1      
 142   1              GPIO_InitStructure.Pin   = GPIO_Pin_2 |GPIO_Pin_3  ;    //Ö¸¶¨Òª³õÊ¼»¯µÄIO,
 143   1              GPIO_InitStructure.Mode = GPIO_PullUp;                          //Ö¸¶¨IOµÄÊäÈë»òÊä³ö·½Ê½,GPIO_PullUp,GPIO_HighZ,GPIO_OUT_OD,GPI
             -O_OUT_PP
 144   1              GPIO_Inilize(GPIO_P3,&GPIO_InitStructure);      
 145   1              
 146   1      }
 147          
 148          /************************ ¶¨Ê±Æ÷ÅäÖÃ ****************************/
 149          void    Timer_config(void)
 150          {
 151   1              TIM_InitTypeDef         TIM_InitStructure;                                      //½á¹¹¶¨Òå
 152   1              TIM_InitStructure.TIM_Mode      = TIM_16BitAutoReload;  //Ö¸¶¨¹¤×÷Ä£Ê½,   TIM_16BitAutoReload,TIM_16Bit,TI
             -M_8BitAutoReload,TIM_16BitAutoReloadNoMask
 153   1              TIM_InitStructure.TIM_Polity    = PolityHigh;                   //Ö¸¶¨ÖÐ¶ÏÓÅÏÈ¼¶, PolityHigh,PolityLow
 154   1              TIM_InitStructure.TIM_Interrupt = ENABLE;                               //ÖÐ¶ÏÊÇ·ñÔÊÐí,   ENABLE»òDISABLE
 155   1              TIM_InitStructure.TIM_ClkSource = TIM_CLOCK_12T;                        //Ö¸¶¨Ê±ÖÓÔ´,     TIM_CLOCK_1T,TIM_CLOCK_12T,TIM_CLOCK
             -_Ext
 156   1              TIM_InitStructure.TIM_ClkOut    = DISABLE;                              //ÊÇ·ñÊä³ö¸ßËÙÂö³å, ENABLE»òDISABLE
 157   1              TIM_InitStructure.TIM_Value     =  0x3cb0;//65536UL - (50.0/1000.0 * MAIN_Fosc/12.0);           
 158   1              // //³õÖµ,50ºÁÃëÒ»´ÎÖÐ¶Ï.
 159   1              TIM_InitStructure.TIM_Run       = ENABLE;                               //ÊÇ·ñ³õÊ¼»¯ºóÆô¶¯¶¨Ê±Æ÷, ENABLE»òDISABLE
 160   1              Timer_Inilize(Timer0,&TIM_InitStructure);                               //³õÊ¼»¯Timer0    Timer0,Timer1,Timer2
 161   1      
 162   1      }
 163          
 164          
 165          /******************** Ö÷º¯Êý**************************/
 166          void main(void)
 167          {
 168   1              //µÍµçÑ¹¼ì²â±£»¤
 169   1              PCON &= ~LVDF;                  //ÉÏµçºóÐèÒªÇåLVDÖÐ¶Ï±êÖ¾Î»
 170   1          ELVD = 1;                       //Ê¹ÄÜLVDÖÐ¶Ï
 171   1          
 172   1              //io ½ÅÅäÖÃ
 173   1              GPIO_config();
 174   1      
 175   1          //È«¾Ö±äÁ¿³õÊ¹»¯
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 4   

 176   1              // ¹¤×÷µÆ¿ªÊ¼
 177   1          ioOutForL1Green=ioInKeyForMoto=ioInKeyForTime=1; //key¼üÀ­¸ß
 178   1      
 179   1          //Êä³öio½ÅÏÈ¹Ø±Õ
 180   1          ioOutForL2Red =ioOutForMotoPower = 0;
 181   1      
 182   1          //ioOutForMotoKey=1; //´¥·¢ÅçÏã»úµÄ°´¼ü¿ª¹Ø. µÍÎ»¿ª£¬¸ßÎ»¹Ø.
 183   1              
 184   1                 
 185   1          //g_allKeyState = {0,0,0};
 186   1      
 187   1      
 188   1          //¿ªÆôÒý½Åp32 p33µÄÍâ²¿ÖÐ¶Ï,ÏÂ½µÑØÖÐ¶Ï.
 189   1          //EXTI_config();
 190   1          
 191   1              //¶¨Ê±Æ÷ÅäÖÃ 50ms Ò»´Î¶¨Ê±£¬¶¨Ê±Æ÷´¥·¢Ê±£¬cpu½øÈë»½ÐÑÊ±¶Î.
 192   1              Timer_config();
 193   1      
 194   1              EA = 1;
 195   1                       
 196   1              //PrintString("\r\n ¿ªÊ¼¹¤×÷ÁË... = ");
 197   1      
 198   1              while (1)
 199   1              {
 200   2                      key_scan();
 201   2      
 202   2                              /*
 203   2                      Ö´ÐÐÈÎÎñ¶¯×÷1
 204   2      
 205   2                      Ò»ÌìÅçÊ±¼äÉèÖÃÎª£º7µã£¬13µã£¬19µã(Õû)
 206   2                      */
 207   2                      switch(g_hour){
 208   3                              case 7:
 209   3                              case 13:
 210   3                              case 19:
 211   3                                  {
 212   4                                          if( g_minute==0 && g_second ==0 && 
 213   4                                          g_millisecond<51 )
 214   4                                           {
 215   5                                                    motoStart();
 216   5                                              }
 217   4                                  }
 218   3                                  break;
 219   3                                  
 220   3                               default:
 221   3                                  break;
 222   3                          }
 223   2      
 224   2              }
 225   1      }
 226          
 227          /***ÄÚ²¿¹¦ÄÜº¯Êý***/
 228          
 229          // °´¼ü´¦Àí¹¦ÄÜ
 230          void key_scan(void) {
 231   1      
 232   1              //moto   
 233   1              
 234   1               if(ioInKeyForMoto==0){
 235   2                      
 236   2                 while(ioInKeyForMoto==0);
 237   2                 //
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 5   

 238   2                 //´¥·¢ÅçÏã»ú¹¤×÷
 239   2                      motoStart();
 240   2                      l2ShowWithNum(l2Num_MotoRun_2);
 241   2              }
 242   1      
 243   1              //time           ioInKeyForTime
 244   1              if(ioInKeyForTime==0){
 245   2                      
 246   2                 while(ioInKeyForTime==0);
 247   2                 //
 248   2                 //ÖØÖÃÊ±¼äÎª12µã.
 249   2                      g_hour = 12;
 250   2                      g_minute=g_second=g_millisecond =0;
 251   2      
 252   2              l2ShowWithNum(l2Num_TimeRest_1);
 253   2              }
 254   1      
 255   1      
 256   1       /*
 257   1              if(g_allKeyState.sKeyForMoto == 1) {
 258   1                      //Çå¿ÕÔ­×´Ì¬
 259   1                      g_allKeyState.sKeyForMoto = 0;
 260   1      
 261   1                      
 262   1                      
 263   1              }
 264   1      
 265   1              if(g_allKeyState.sKeyForRun== 1) {
 266   1      
 267   1                      //Í£Ö¹APPÔËÐÐ
 268   1                      while(g_allKeyState.sKeyForRun){;};
 269   1                      
 270   1                      //Çå¿ÕÔ­×´Ì¬
 271   1                      //g_allKeyState.sKeyForRun = 0;
 272   1              }
 273   1      
 274   1              if(g_allKeyState.sKeyForTime== 1) {
 275   1                      //Çå¿ÕÔ­×´Ì¬
 276   1                      g_allKeyState.sKeyForTime = 0;
 277   1      
 278   1                      
 279   1                      
 280   1              }       
 281   1      
 282   1              */
 283   1      }
 284          
 285          //ÁÁµÆÏìÓ¦
 286          /*
 287          3¡¢L1(ÂÌio0)ÏÔÊ¾µ±Ç°×´Ì¬£¬
 288          10ÃëÉÁÒ»´Î£¬±íÊ¾»úÆ÷¶¨Ê±ÔËÐÐÖÐ¡£
 289          ³£ÁÁ±íÊ¾µç³Ø²»×ã¡£
 290          
 291          L2(ºìio1)ÉÁÒ»´Î£¬±íÊ¾Ê±¼ä½Ï×¼Íê³É¡£
 292          L2(ºì)ÉÁ¶þ´Î£¬±íÊ¾´¥·¢ÅçÏã»ú¹¤×÷¡£ 
 293          L2(ºì)ÉÁÈý´Î£¬±íÊ¾¹Ø±ÕAPPÔËÐÐ
 294          */ 
 295          
 296          void l2ShowWithNum(u8 num)
 297          {
 298   1              int i;
 299   1          //PrintString("\r\n l2ShowWithNum.");
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 6   

 300   1                      
 301   1              for(i=0; i<num; i++)
 302   1              {
 303   2                      delay_ms(100);
 304   2                      ioOutForL2Red = 1;
 305   2                      delay_ms(100);
 306   2                      ioOutForL2Red = 0;
 307   2      
 308   2              }       /**/
 309   1      }       
 310          
 311          /*µç»ú¿ØÖÆ
 312          
 313          1.´ò¿ªp34,      (10Ãë) ºó¹Ø±Õ(Ïàµ±ÓÚ¿ª¹ØµçÔ´)
 314          2.µÈ´ýÅçÏã»úÆô¶¯,Ô¼(1Ãë)ÖÓ,¼´8(k_moto_run_time-2)ÃëÊ±Æô¶¯²Ù×÷.
 315          3.´ò¿ªp35, 20us Ãë¹Ø±Õ(Ä£ËÆ°´¼ü)
 316          */
 317          void motoStart(void) {
 318   1      
 319   1                              //Æô¶¯µç»ú³ÌÐò
 320   1                              ioOutForL2Red = 1;
 321   1                              ioOutForMotoPower = 1; //¿ªÆôµçÔ´
 322   1              
 323   1                      delay_ms(400);
 324   1              
 325   1                      ioOutForL2Red = 0; //¹Øµç»úÔËÐÐÖ¸Ê¾µÆ
 326   1                       //¹Ø±Õµç»úµçÔ´
 327   1                       ioOutForMotoPower= 0;
 328   1                       g_moto_run_time=0;
 329   1                   
 330   1          //PrintString("\r\n motoStart. ");
 331   1      }
 332          
 333          //void milliAction(void){
 334          //       
 335          //        if(g_moto_run_time==0){
 336          //                                //ioOutForMotoPower= 0;
 337          //        }
 338          //      else {
 339          //
 340          //                        
 341          //                       
 342          //             }
 343          //
 344          //        
 345          //
 346          //        return ;   
 347          //}
 348          
 349          void secondAction(void) {
 350   1              //PrintString("\r\n secondAction... ");
 351   1              //printNowTime();
 352   1          
 353   1              if(g_second%10 == 0){   //¹¤×÷Ö¸Ê¾µÆ(ÂÌ)
 354   2                      ioOutForL1Green = 1;
 355   2                      //delay_ms(200);
 356   2                      
 357   2              }
 358   1          else {
 359   2                  ioOutForL1Green = 0;
 360   2              }
 361   1              
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 7   

 362   1      }
 363          
 364          
 365          /********************* Timer0ÖÐ¶Ïº¯Êý************************/
 366          void timer0_int (void) interrupt TIMER0_VECTOR
 367          {
 368   1              g_millisecond += k_addNum;
 369   1      
 370   1         //50mÒ»´Î.
 371   1      
 372   1         if(g_millisecond>400){
 373   2                       
 374   2         }
 375   1      
 376   1              if( g_millisecond>= 1000) { //Âú×ãÒ»Ãë
 377   2                      g_millisecond = 0;
 378   2              
 379   2                      secondAction();
 380   2                      //milliAction();
 381   2                      g_second++;
 382   2      
 383   2                      if(g_second >=60){
 384   3      
 385   3                              //Âú×ãÒ»·ÖÖÓ
 386   3                              //mintueAction();
 387   3      
 388   3                              
 389   3                              g_second =0;
 390   3                              g_minute ++;
 391   3      
 392   3                              if(g_minute >=60){
 393   4      
 394   4                                      //Âú×ãÒ»Ð¡Ê±
 395   4                                      g_minute =0;
 396   4                                      g_hour ++;
 397   4      
 398   4                                      if(g_hour >=24){
 399   5      
 400   5                                              //Âú×ã24Ð¡Ê±
 401   5                                              g_hour =0;
 402   5                              
 403   5                                      }
 404   4                              
 405   4                              }
 406   3                      }
 407   2              }
 408   1      }
 409          
 410          /*
 411          sbit ioInKeyForTime = P3^2; //Ê±¼ä½Ï×¼°´¼üÊäÈë  int0
 412          sbit ioInKeyForRun  = P3^3;//³ÌÐòÊÇ·ñÔËÐÐÊäÈë   int1
 413          sbit ioInKeyForMoto =P3^5;//ÅçÏã»ú´¥·¢ÔËÐÐÊäÈë  int3
 414          */
 415          
 416          /********************* INT0ÖÐ¶Ïº¯Êý *************************/
 417          void INT0_int (void) interrupt INT0_VECTOR              //½øÖÐ¶ÏÊ±ÒÑ¾­Çå³ý±êÖ¾
 418          {
 419   1              //WakeUpSource = 1;     //±ê¼ÇINT0»½ÐÑ
 420   1              //EX0 = 0;                      //INT0 Disable
 421   1      
 422   1              IE0  = 0;                       //ÍâÖÐ¶Ï0±êÖ¾Î»
 423   1              while(ioInKeyForMoto==0);
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 8   

 424   1              //g_allKeyState.sKeyForMoto= 1;
 425   1              //PrintString("\r\n Íâ²¿ÖÐ¶Ï0.");
 426   1              
 427   1              EX0 = 1;
 428   1      
 429   1              
 430   1      }
 431          
 432          /********************* INT1ÖÐ¶Ïº¯Êý *************************/
 433          void INT1_int (void) interrupt INT1_VECTOR              //½øÖÐ¶ÏÊ±ÒÑ¾­Çå³ý±êÖ¾
 434          {
 435   1              //½øÈëÖÐ¶ÏÊ±£¬¿ÉÒÔ°Ñint1ÖÐ¶Ï¹Ø±Õ¡£
 436   1              EX1 = 0;        
 437   1              //tfWakeUpSource = 2;   //±ê¼ÇINT1»½ÐÑ
 438   1              //EX1 = 0;                      //INT1 Disable
 439   1              IE1  = 0;                       //ÍâÖÐ¶Ï1±êÖ¾Î»
 440   1      
 441   1              if(ioInKeyForTime!=0) 
 442   1              {        
 443   2                      EX1 = 1;
 444   2                      return;
 445   2              }
 446   1      
 447   1              g_allKeyState.sKeyForTime= 1;
 448   1              g_allKeyState.sKeyForMoto= 1;
 449   1              //´¦ÀíÍêÖÐ¶ÏÊÂ¼þºó£¬¿ÉÒÔ°Ñ int1ÖÐ¶Ï¿ªÆô£¬·ÀÖ¹¶à´Î½øÈë¡£
 450   1      
 451   1         // PrintString("\r\n Íâ²¿ÖÐ¶Ï1.ÑÓÊ±1Ãë");
 452   1         // delay_ms(2000);
 453   1          while(ioInKeyForTime==0);
 454   1              EX1 = 1;          //³ÌÐò¼ü×´Ì¬Öµ.  0: Î´°´ÏÂ  //1:ÒÑ°´ÏÂ
 455   1        
 456   1      }
 457          
 458          /********************* INT3ÖÐ¶Ïº¯Êý ***********************
 459          void INT3_int  (void) interrupt INT3_VECTOR
 460          {
 461              PrintString("\r\n Íâ²¿ÖÐ¶Ï3.ÑÓÊ±1Ãë");
 462          
 463          //
 464              INT_CLKO |=  (1 << 5);  //ÔÊÐíÖÐ¶Ï  
 465              INT_CLKO &= ~(1 << 5);  //½ûÖ¹ÖÐ¶Ï
 466          ///
 467                  //EX3 = 0;      
 468              //IE1  = 0; 
 469          
 470                  g_allKeyState.sKeyForMoto= 1;
 471          }
 472          */
 473          
 474          ///µÍµçÑ¹ÖÐ¶Ïº¯Êý
 475          //Èç¹ûµÍµçÑ¹£¬½«             LVD_VECTOR         6
 476          void LVD_ISR() interrupt 6 using 1
 477          {       
 478   1              //
 479   1              ioOutForL2Red   = 1; //³£ÁÁ£¬±íÊ¾µçÑ¹²»×ã
 480   1              ioOutForL1Green= 0; //Ï¨µÆ
 481   1              ioOutForMotoPower =0; //Ç¿ÖÆÍ£Ö¹ÔË×ª.
 482   1      
 483   1              PCON &= ~LVDF;                  //ÏòPCON.5Ð´0ÇåLVDÖÐ¶Ï
 484   1      
 485   1              //PCON |= 0x02;               //½øÈëµôµçÄ£Ê½
C51 COMPILER V9.00   MAIN                                                                  11/18/2018 23:28:46 PAGE 9   

 486   1      }
 487          
 488          /*
 489          void printNowTime(void) {
 490          
 491                  PrintString("\r\n ....");
 492          
 493                  TxSend('H');
 494                  //TxSend(g_hour+ '0');
 495                  TxSend(g_hour%100/10 + '0');
 496                  TxSend(g_hour%10+ '0');
 497                  
 498          
 499                  TxSend(' ');
 500                  TxSend('M');
 501                  TxSend(g_minute%100/10 + '0');
 502                  TxSend(g_minute%10+ '0');
 503          
 504                  TxSend(' ');
 505                  TxSend('S');
 506                  //TxSend(g_second+ '0');
 507                  TxSend(g_second%100/10 + '0');
 508                  TxSend(g_second%10+ '0');
 509          
 510          //
 511                  TxSend(' ');
 512                  TxSend('U');
 513                  //TxSend(g_millisecond+ '0');
 514                  TxSend(g_millisecond%1000/100 + '0');
 515                  TxSend(g_millisecond%100/10 + '0');
 516                  TxSend(g_millisecond%10+ '0');
 517          //
 518                  
 519                  PrintString("\r\n ");
 520          }
 521          */
 522          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    407    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9      16
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
